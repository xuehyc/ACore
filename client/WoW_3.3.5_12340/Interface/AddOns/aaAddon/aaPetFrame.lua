local _G = _G; local GameTooltip = GameTooltip; local ItemRefTooltip = ItemRefTooltip; local ShoppingTooltip1 = ShoppingTooltip1; local ShoppingTooltip2 = ShoppingTooltip2; local ShoppingTooltip2 = ShoppingTooltip3; aaPetFrame = {}; aaPetFrame.selectItemId = 0; aaPetFrame.selectItemEntry = 0; aaPetFrame.mainView = {}; local msgdata = {}; local selectItemDBName = ""; local selectItemName = ""; local btns; local selectIndex = 1; local selectItemLink = nil; local buttonTitles1 = {"Interface\\AddOns\\aaAddon\\Icons\\aa-cw-ksfh1","Interface\\AddOns\\aaAddon\\Icons\\aa-cw-ksqh1","Interface\\AddOns\\aaAddon\\Icons\\aa-cw-ksjh1","Interface\\AddOns\\aaAddon\\Icons\\aa-cw-ksjx1","Interface\\AddOns\\aaAddon\\Icons\\aa-cw-kscs1"}; local buttonTitles2 = {"Interface\\AddOns\\aaAddon\\Icons\\aa-cw-ksfh2","Interface\\AddOns\\aaAddon\\Icons\\aa-cw-ksqh2","Interface\\AddOns\\aaAddon\\Icons\\aa-cw-ksjh2","Interface\\AddOns\\aaAddon\\Icons\\aa-cw-ksjx2","Interface\\AddOns\\aaAddon\\Icons\\aa-cw-kscs2"}; local ClickDoneBtn = function() PlaySound("INTERFACESOUND_GAMESCROLLBUTTON", "Master"); if selectIndex == 1 then aaData:sendAddonMsg(100,aaPetFrame.selectItemId.."\t"..aaPetFrame.selectItemEntry, "GUILD"); elseif selectIndex == 2 then aaData:sendAddonMsg(101,aaPetFrame.selectItemId.."\t"..aaPetFrame.selectItemEntry, "GUILD"); elseif selectIndex == 3 then aaData:sendAddonMsg(102,aaPetFrame.selectItemId.."\t"..aaPetFrame.selectItemEntry, "GUILD"); elseif selectIndex == 4 then aaData:sendAddonMsg(103,aaPetFrame.selectItemId.."\t"..aaPetFrame.selectItemEntry, "GUILD"); elseif selectIndex == 5 then aaData:sendAddonMsg(104,aaPetFrame.selectItemId.."\t"..aaPetFrame.selectItemEntry, "GUILD"); end; end; function aaPetFrame:CallBack(tag) tag = tag + 0; if tag == 100 or tag == 101 or tag == 102 or tag == 103 or tag == 104 then aaDataPet:GetHttpItem(aaPetFrame.selectItemId, aaPetFrame.selectItemEntry); end; end; function aaPetFrame:ClearData() aaPetFrame.mainView.bgView.DoneButton:Disable(); aaPetFrame.selectItemId = 0; aaPetFrame.selectItemEntry = 0; aaPetFrame.mainView.bgView.ItemButton:SetNormalTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-cao"); ClearCursor(); stattext:SetText(""); needtext:SetText(""); aaPetFrame:reload(); end; local ClickMenuBtn = function(index) PlaySound("INTERFACESOUND_GAMESCROLLBUTTON", "Master"); if index ~= 7 then selectIndex = index; for i = 1,#btns do btns[i]:SetAlpha(0.5); end; aaPetFrame.mainView.bgView.DoneButton:SetNormalTexture(buttonTitles1[index]); aaPetFrame.mainView.bgView.DoneButton:SetDisabledTexture(buttonTitles2[index]); aaPetFrame.mainView.bgView.DoneButton:SetHighlightTexture(buttonTitles1[index]); aaPetFrame.mainView.bgView.DoneButton:SetPushedTexture(buttonTitles1[index]); btns[index]:SetAlpha(1); aaPetFrame:reload(); else local infoType, _, itemLink = GetCursorInfo(); if (infoType == "item") then selectItemLink = itemLink; local itemString = string.match(itemLink, "item[%-?%d:]+"); local _, itementry, _, _, suffixId1, suffixId2, _, _, _, _= strsplit(":", itemString); local suffixId = (suffixId1 - 5000) * 10000 + suffixId2 - 5000; aaPetFrame.selectItemEntry = itementry - 0; aaPetFrame.selectItemId = suffixId - 0; local item = aaDataPet:getItem(aaPetFrame.selectItemId, aaPetFrame.selectItemEntry); if aaPetFrame.selectItemId > 0 and item then itemName = aaData:getItemName(itementry); local icon = GetItemIcon(itementry); aaPetFrame.mainView.bgView.ItemButton:SetNormalTexture(icon); aaPetFrame:reload(); ClearCursor(); end; else aaPetFrame:ClearData(); end; end; end; function aaPetFrame:show() aaPetFrame.mainView:Show(); ClickMenuBtn(1); end; function aaPetFrame:hide() aaPetFrame.mainView:Hide(); aaPetFrame:ClearData(); end; function aaPetFrame:reload() if aaPetFrame.selectItemId > 0 then for k,v in pairs(msgdata) do selectItemName = aaDataPet:get_name(aaPetFrame.selectItemId, aaPetFrame.selectItemEntry, v); selectItemDBName = aaDataPet:get_dbname(aaPetFrame.selectItemId, aaPetFrame.selectItemEntry, v); end; aaPetFrame.mainView.bgView.DoneButton:Enable(); local item = aaDataPet:getItem(aaPetFrame.selectItemId, aaPetFrame.selectItemEntry); if item then if selectIndex == 1 then if item[8] == 0 and item[7] > 0 then local petnonsuchid = 0; for k,v in pairs(petnonsuch) do if v and v[1] == item[7] and v[2] == 1 then petnonsuchid = k; end; end; if petnonsuchid > 0 and petnonsuch[petnonsuchid] then stattext:SetText(aaData.color_blue.."宠物掉落："..aaData.color_yellow.."\n任何怪物都有几率掉落。\n\n"..aaData.color_blue.."宠物孵化：\n"..aaData.color_yellow.."获取资质并领悟天赋"); local needid = petnonsuch[petnonsuchid][5]; if needid and needid ~= "" and needid > 0 then aaData.reload_need[needid] = "aaPetFrame"; local need = aaData:getNeed(needid, 1); if need ~= "" then needtext:SetText(selectItemName.."\n\n"..aaData.color_blue.."孵化条件：\n"..aaData.color_yellow..need); end; end; aaPetFrame.mainView.bgView.DoneButton:Enable(); else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("无法孵化"); needtext:SetText(""); end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("该宠物已孵化"); needtext:SetText(""); end; elseif selectIndex == 2 then if item[8] > 0 then local upgradeid = 0; if item[17] + 0 == 0 then for k,v in pairs(petupgrade) do if v[1] == item[18] and v[2] == 1 then upgradeid = k; end; end; else upgradeid = item[17] + 1; end; if petupgrade[upgradeid] and petupgrade[upgradeid][1] == item[18] then local value = ""; if petupgrade[upgradeid][4] > petupgrade[upgradeid][5] then value = value.."+".." "..petupgrade[upgradeid][4].."%"; elseif petupgrade[upgradeid][3] > petupgrade[upgradeid][4] then value = value.."+".." "..petupgrade[upgradeid][4].."% ~ "..petupgrade[upgradeid][5].."%\n"; end; stattext:SetText(aaData.color_blue.."强化成功预览".."\n\n"..aaData.color_blue.."强化等级：\n"..aaData:get_star(petupgrade[upgradeid][2]).."\n"..aaData.color_blue.."所有属性继续提升：\n"..aaData.color_green..value); local needid = petupgrade[upgradeid][7]; if needid and needid ~= "" and needid > 0 then aaData.reload_need[needid] = "aaPetFrame"; local need = aaData:getNeed(needid, 1); if need ~= "" then local destroy = ""; if petupgrade[upgradeid][6] == 0 then destroy = aaData.color_blue.."无变化"; elseif petupgrade[upgradeid][6] == 1 then destroy = aaData.color_red.."强化等级清零"; elseif petupgrade[upgradeid][6] == 2 then destroy = aaData.color_red.."宠物销毁"; end; needtext:SetText(selectItemName.."\n\n"..aaData.color_blue.."强化条件：\n"..aaData.color_yellow..need.."\n\n"..aaData.color_blue.."成功几率：\n"..aaData.color_white..petupgrade[upgradeid][3].."% ".."\n\n"..aaData.color_blue.."强化失败："..destroy); end; end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("无法强化"); needtext:SetText(""); end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("该宠物未孵化"); needtext:SetText(""); end; elseif selectIndex == 3 then if item[8] > 0 then local petnonsuchid = 0; if item[6] + 0 == 0 then for k,v in pairs(petnonsuch) do if v[1] == item[6] and v[2] == 1 then petnonsuchid = k; end; end; else petnonsuchid = item[6] + 1; end; local i = 0; if petnonsuch[petnonsuchid-1] then local pztext = ""; for k,v in pairs(petnonsuch) do if v and v[1] == item[7] then i = i + 1; if i % 3 == 0 then pztext = pztext..v[3].."\n"; else pztext = pztext..v[3].."≮"; end; end; end; stattext:SetText(aaData.color_blue.."当前品质：\n"..petnonsuch[petnonsuchid-1][3]..aaData.color_blue.."\n\n品质说明：\n"..pztext); if petnonsuch[petnonsuchid] and petnonsuch[petnonsuchid][1] == item[7] then local needid = petnonsuch[petnonsuchid][5]; if needid and needid ~= "" and needid > 0 then aaData.reload_need[needid] = "aaPetFrame"; local need = aaData:getNeed(needid, 1); if need ~= "" then needtext:SetText(selectItemName.."\n\n"..aaData.color_blue.."进化条件：\n"..aaData.color_yellow..need); end; end; else needtext:SetText("已达到最大等级"); end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("无法进化"); needtext:SetText(""); end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("该宠物未孵化"); needtext:SetText(""); end; elseif selectIndex == 4 then if item[8] > 0 then local upgradeid = 0; if item[21] + 0 == 0 then for k,v in pairs(petrune) do if v[1] == item[22] and v[2] == 1 then upgradeid = k; end; end; else upgradeid = item[21] + 1; end; if petrune[upgradeid] and petrune[upgradeid][1] == item[22] then stattext:SetText(aaData.color_blue.."觉醒成功预览".."\n\n"..aaData.color_blue.."觉醒等级：\n"..aaData:get_star(petrune[upgradeid][2]).."\n"..aaData.color_blue.."觉醒说明：\n"..aaData.color_green.."宠物随机学习觉醒技能"); local needid = petrune[upgradeid][5]; if needid and needid ~= "" and needid > 0 then aaData.reload_need[needid] = "aaPetFrame"; local need = aaData:getNeed(needid, 1); if need ~= "" then local destroy = ""; if petrune[upgradeid][4] == 0 then destroy = aaData.color_blue.."无变化"; elseif petrune[upgradeid][4] == 1 then destroy = aaData.color_red.."觉醒等级清零"; elseif petrune[upgradeid][4] == 2 then destroy = aaData.color_red.."宠物销毁"; end; needtext:SetText(selectItemName.."\n\n"..aaData.color_blue.."觉醒条件：\n"..aaData.color_yellow..need.."\n\n"..aaData.color_blue.."成功几率：\n"..aaData.color_white..petrune[upgradeid][3].."% ".."\n\n"..aaData.color_blue.."觉醒失败："..destroy); end; end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("宠物无法觉醒"); needtext:SetText(""); end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("该宠物未孵化"); needtext:SetText(""); end; elseif selectIndex == 5 then if item[8] > 0 then local petnonsuchid = item[6]; if petnonsuch[petnonsuchid] then stattext:SetText("重生说明：\n"..aaData.color_green.."重生会改变宠物的资质属性和天赋技能"); if worldconf[3] then local needid = worldconf[3]; if needid and needid ~= "" and needid > 0 then aaData.reload_need[needid] = "aaPetFrame"; local need = aaData:getNeed(needid, 1); needtext:SetText(selectItemName.."\n\n"..aaData.color_blue.."重生条件：\n"..aaData.color_yellow..need); end; end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("无法重生"); needtext:SetText(""); end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); stattext:SetText("该宠物未孵化"); needtext:SetText(""); end; end; end; else aaPetFrame.mainView.bgView.DoneButton:Disable(); end; end; aaPetFrame.mainView = CreateFrame("Frame","aaPetFrame.mainView",UIParent) do aaPetFrame.mainView:SetFrameStrata("TOOLTIP"); aaPetFrame.mainView:SetWidth(768); aaPetFrame.mainView:SetHeight(512); aaPetFrame.mainView:SetPoint("CENTER"); aaPetFrame.mainView:SetToplevel(true); aaPetFrame.mainView:SetClampedToScreen(true); aaPetFrame.mainView:SetMovable(true); aaPetFrame.mainView:EnableMouse(true); aaPetFrame.mainView:SetScript("OnMouseDown",function() this:StartMoving(); end); aaPetFrame.mainView:SetScript("OnMouseUp",function() this:StopMovingOrSizing(); end); aaPetFrame.mainView:Hide(); tinsert(UISpecialFrames, "aaPetFrame.mainView"); end; aaPetFrame.mainView.bgView1 = CreateFrame("Frame",nil,aaPetFrame.mainView) do aaPetFrame.mainView.bgView1:SetFrameStrata("TOOLTIP"); aaPetFrame.mainView.bgView1:SetBackdrop ({bgFile="Interface\\AddOns\\aaAddon\\Icons\\aa-cw-chongwu1"}); aaPetFrame.mainView.bgView1:SetWidth(512); aaPetFrame.mainView.bgView1:SetHeight(512); aaPetFrame.mainView.bgView1:SetPoint("TOPLEFT",0,0); aaPetFrame.mainView.bgView1:Show(); end; aaPetFrame.mainView.bgView2 = CreateFrame("Frame",nil,aaPetFrame.mainView) do aaPetFrame.mainView.bgView2:SetFrameStrata("TOOLTIP"); aaPetFrame.mainView.bgView2:SetBackdrop ({bgFile="Interface\\AddOns\\aaAddon\\Icons\\aa-cw-chongwu2"}); aaPetFrame.mainView.bgView2:SetWidth(256); aaPetFrame.mainView.bgView2:SetHeight(512); aaPetFrame.mainView.bgView2:SetPoint("TOPLEFT",512,0); aaPetFrame.mainView.bgView2:Show(); end; aaPetFrame.mainView.bgView = CreateFrame("Frame",nil,aaPetFrame.mainView) do aaPetFrame.mainView.bgView:SetFrameStrata("TOOLTIP"); aaPetFrame.mainView.bgView:SetWidth(758); aaPetFrame.mainView.bgView:SetHeight(512); aaPetFrame.mainView.bgView:SetPoint("TOPLEFT",0,0); aaPetFrame.mainView.bgView:Show(); end; local buttonWidth = 128; local buttonHeight = 64; local buttonTop = -100; aaPetFrame.mainView.bgView.QHButton = CreateFrame('Button', nil, aaPetFrame.mainView.bgView, '') do aaPetFrame.mainView.bgView.QHButton:SetAlpha(1); aaPetFrame.mainView.bgView.QHButton:SetPoint('CENTER', aaPetFrame.mainView.bgView, 'CENTER', -2*buttonWidth-36+3, -170); aaPetFrame.mainView.bgView.QHButton:SetSize(buttonWidth, buttonHeight); aaPetFrame.mainView.bgView.QHButton:SetNormalTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-fuhua1"); aaPetFrame.mainView.bgView.QHButton:SetDisabledTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-fuhua2"); aaPetFrame.mainView.bgView.QHButton:SetHighlightTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-fuhua1"); aaPetFrame.mainView.bgView.QHButton:SetPushedTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-fuhua1"); aaPetFrame.mainView.bgView.QHButton:SetScript('OnClick', function() ClickMenuBtn(1); end); end; aaPetFrame.mainView.bgView.QHButton1 = CreateFrame('Button', nil, aaPetFrame.mainView.bgView, '') do aaPetFrame.mainView.bgView.QHButton1:SetAlpha(0.5); aaPetFrame.mainView.bgView.QHButton1:SetPoint('CENTER', aaPetFrame.mainView.bgView, 'CENTER', -buttonWidth-18+3, -170); aaPetFrame.mainView.bgView.QHButton1:SetSize(buttonWidth, buttonHeight); aaPetFrame.mainView.bgView.QHButton1:SetNormalTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-qianghua1"); aaPetFrame.mainView.bgView.QHButton1:SetDisabledTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-qianghua2"); aaPetFrame.mainView.bgView.QHButton1:SetHighlightTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-qianghua1"); aaPetFrame.mainView.bgView.QHButton1:SetPushedTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-qianghua1"); aaPetFrame.mainView.bgView.QHButton1:SetScript('OnClick', function() ClickMenuBtn(2); end); end; aaPetFrame.mainView.bgView.QHButton2 = CreateFrame('Button', nil, aaPetFrame.mainView.bgView, '') do aaPetFrame.mainView.bgView.QHButton2:SetAlpha(0.5); aaPetFrame.mainView.bgView.QHButton2:SetPoint('CENTER', aaPetFrame.mainView.bgView, 'CENTER', 3, -170); aaPetFrame.mainView.bgView.QHButton2:SetSize(buttonWidth, buttonHeight); aaPetFrame.mainView.bgView.QHButton2:SetNormalTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-jinhua1"); aaPetFrame.mainView.bgView.QHButton2:SetDisabledTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-jinhua2"); aaPetFrame.mainView.bgView.QHButton2:SetHighlightTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-jinhua1"); aaPetFrame.mainView.bgView.QHButton2:SetPushedTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-jinhua1"); aaPetFrame.mainView.bgView.QHButton2:SetScript('OnClick', function() ClickMenuBtn(3); end); end; aaPetFrame.mainView.bgView.QHButton3 = CreateFrame('Button', nil, aaPetFrame.mainView.bgView, '') do aaPetFrame.mainView.bgView.QHButton3:SetAlpha(0.5); aaPetFrame.mainView.bgView.QHButton3:SetPoint('CENTER', aaPetFrame.mainView.bgView, 'CENTER', buttonWidth+18+3, -170); aaPetFrame.mainView.bgView.QHButton3:SetSize(buttonWidth, buttonHeight); aaPetFrame.mainView.bgView.QHButton3:SetNormalTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-juexing1"); aaPetFrame.mainView.bgView.QHButton3:SetDisabledTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-juexing2"); aaPetFrame.mainView.bgView.QHButton3:SetHighlightTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-juexing1"); aaPetFrame.mainView.bgView.QHButton3:SetPushedTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-juexing1"); aaPetFrame.mainView.bgView.QHButton3:SetScript('OnClick', function() ClickMenuBtn(4); end); end; aaPetFrame.mainView.bgView.QHButton4 = CreateFrame('Button', nil, aaPetFrame.mainView.bgView, '') do aaPetFrame.mainView.bgView.QHButton4:SetAlpha(0.5); aaPetFrame.mainView.bgView.QHButton4:SetPoint('CENTER', aaPetFrame.mainView.bgView, 'CENTER', 2*buttonWidth+36+3, -170); aaPetFrame.mainView.bgView.QHButton4:SetSize(buttonWidth, buttonHeight); aaPetFrame.mainView.bgView.QHButton4:SetNormalTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-chongsheng1"); aaPetFrame.mainView.bgView.QHButton4:SetDisabledTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-chongsheng2"); aaPetFrame.mainView.bgView.QHButton4:SetHighlightTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-chongsheng1"); aaPetFrame.mainView.bgView.QHButton4:SetPushedTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-chongsheng1"); aaPetFrame.mainView.bgView.QHButton4:SetScript('OnClick', function() ClickMenuBtn(5); end); end; btns = {aaPetFrame.mainView.bgView.QHButton,aaPetFrame.mainView.bgView.QHButton1,aaPetFrame.mainView.bgView.QHButton2,aaPetFrame.mainView.bgView.QHButton3,aaPetFrame.mainView.bgView.QHButton4}; aaPetFrame.mainView.bgView.ItemButton = CreateFrame('Button', nil, aaPetFrame.mainView.bgView, '') do aaPetFrame.mainView.bgView.ItemButton:SetPoint('CENTER', aaPetFrame.mainView.bgView, 'CENTER', 6, 65); aaPetFrame.mainView.bgView.ItemButton:SetSize(64, 64); aaPetFrame.mainView.bgView.ItemButton:SetNormalTexture("Interface\\AddOns\\aaAddon\\Icons\\aa-cw-cao"); aaPetFrame.mainView.bgView.ItemButton:SetScript('OnClick', function() ClickMenuBtn(7); end); aaPetFrame.mainView.bgView.ItemButton:Show(); end; aaPetFrame.mainView.bgView.ItemButton:SetScript('OnEnter', function() if selectItemLink ~= nil and aaPetFrame.selectItemId > 0 then ShowUIPanel(ItemRefTooltip); ItemRefTooltip:SetToplevel(true); if (not ItemRefTooltip:IsVisible()) then ItemRefTooltip:SetOwner(aaPetFrame.mainView.bgView, "ANCHOR_NONE"); end ItemRefTooltip:SetPoint("BOTTOMLEFT",aaPetFrame.mainView.bgView,"TOPRIGHT"); ItemRefTooltip:ClearLines(); ItemRefTooltip:SetHyperlink(selectItemLink); ItemRefTooltip:Show(); end; end); aaPetFrame.mainView.bgView.ItemButton:SetScript('OnLeave', function() ItemRefTooltip:Hide(); end); aaPetFrame.mainView.bgView.DoneButton = CreateFrame('Button', nil, aaPetFrame.mainView.bgView, '') do aaPetFrame.mainView.bgView.DoneButton:SetPoint('CENTER', aaPetFrame.mainView.bgView, 'CENTER', 3, -50); aaPetFrame.mainView.bgView.DoneButton:SetSize(128, 32); aaPetFrame.mainView.bgView.DoneButton:SetNormalTexture(buttonTitles1[1]); aaPetFrame.mainView.bgView.DoneButton:SetDisabledTexture(buttonTitles2[1]); aaPetFrame.mainView.bgView.DoneButton:SetHighlightTexture(buttonTitles1[1]); aaPetFrame.mainView.bgView.DoneButton:SetPushedTexture(buttonTitles1[1]); aaPetFrame.mainView.bgView.DoneButton:Disable(); aaPetFrame.mainView.bgView.DoneButton:SetScript('OnClick', function() ClickDoneBtn(); end); end; aaPetFrame.mainView.bgView.CancelButton = CreateFrame('Button', nil, aaPetFrame.mainView.bgView, 'UIPanelCloseButton') do aaPetFrame.mainView.bgView.CancelButton:SetNormalTexture("Interface\\AddOns\\aaAddon\\Icons\\cha"); aaPetFrame.mainView.bgView.CancelButton:SetPoint('TOPRIGHT', aaPetFrame.mainView.bgView, 'TOPRIGHT', -8, -25); aaPetFrame.mainView.bgView.CancelButton:SetSize(44, 44); aaPetFrame.mainView.bgView.CancelButton:SetScript('OnClick', function() aaPetFrame:hide(); end); end; aaPetFrame.mainView.bgView.detailView1 = CreateFrame("Frame",nil,aaPetFrame.mainView.bgView) do aaPetFrame.mainView.bgView.detailView1:SetFrameStrata("TOOLTIP"); aaPetFrame.mainView.bgView.detailView1:SetWidth(260); aaPetFrame.mainView.bgView.detailView1:SetHeight(225); aaPetFrame.mainView.bgView.detailView1:SetPoint("TOPLEFT",aaPetFrame.mainView.bgView,'TOPLEFT',40,-130); aaPetFrame.mainView.bgView.detailView1:Show(); stattext = aaPetFrame.mainView.bgView.detailView1:CreateFontString("stattext", "OVERLAY", "GameFontNormal") do stattext:SetFont("Interface\\AddOns\\aaAddon\\Font\\aaFont.TTF", 16); stattext:SetPoint("TOPLEFT", aaPetFrame.mainView.bgView.detailView1, "TOPLEFT", 5, -10); stattext:SetAllPoints(aaPetFrame.mainView.bgView.detailView1); stattext:SetSpacing(5); end; end; aaPetFrame.mainView.bgView.detailView2 = CreateFrame("Frame",nil,aaPetFrame.mainView.bgView) do aaPetFrame.mainView.bgView.detailView2:SetFrameStrata("TOOLTIP"); aaPetFrame.mainView.bgView.detailView2:SetWidth(260); aaPetFrame.mainView.bgView.detailView2:SetHeight(225); aaPetFrame.mainView.bgView.detailView2:SetPoint("TOPLEFT",aaPetFrame.mainView.bgView,'TOPLEFT',40+260+170,-130); aaPetFrame.mainView.bgView.detailView2:Show(); needtext = aaPetFrame.mainView.bgView.detailView2:CreateFontString("needtext", "OVERLAY", "GameFontNormal") do needtext:SetFont("Interface\\AddOns\\aaAddon\\Font\\aaFont.TTF", 15); needtext:SetPoint("TOP", aaPetFrame.mainView.bgView.detailView2, "TOP", 0, -10); needtext:SetAllPoints(aaPetFrame.mainView.bgView.detailView2); needtext:SetSpacing(5); end; end;